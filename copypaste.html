<html>
<head>
<script language="javascript">
function paste() {
    var clipText;
    var clipTable;
    navigator.clipboard.readText()
    .then(text => {
        clipText = text;
        console.log('Pasted content: ', text);
        clipRows = clipText.split("\n");
        for (i=0; i<clipRows.length; i++) {
            // clipTable[];
            clipRows[i] = clipRows[i].split(String.fromCharCode(9));
        }
        // write out in a table
        newTable = document.createElement("table")
        newTable.border = 1;
        for (i=0; i<clipRows.length; i++) {
            newRow = newTable.insertRow();
            for (j=0; j<clipRows[i].length; j++) {
                newCell = newRow.insertCell();
                if (clipRows[i][j].length == 0) {
                    newCell.innerText = ' ';
                }
                else {
                    newCell.innerText = clipRows[i][j];
                }
            }
        }
        document.body.appendChild(newTable);
    })
    .catch(err => {
        console.error('Failed to read clipboard contents: ', err);
    });
}
function copy() {
    var table = document.getElementsByTagName('table');
    navigator.clipboard.writeText(table[0].innerText);
}
</script>
</head>
<body>
<input type="button" value="paste" onclick="paste()">
<input type="button" value="copy" onclick="copy()">
</body>
</html>